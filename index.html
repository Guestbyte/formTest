<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTML forms to Google Sheet</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@2.5.14/dist/vuetify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify@2.5.14/dist/vuetify.js"></script>
  
</head>

<body>
  <div id="app">
    <v-app>
      <template>
        <v-app-bar app color="#0077B5" dark>
          <v-app-bar-nav-icon @click.stop="toggleDrawer"></v-app-bar-nav-icon>
          <v-toolbar-title>LinkedIn-like Header</v-toolbar-title>
          <v-spacer></v-spacer>
          <v-btn text>Home</v-btn>
          <v-btn text>My Network</v-btn>
          <v-btn text>Jobs</v-btn>
          <v-btn text>Messaging</v-btn>
          <v-btn text>Notifications</v-btn>
          <v-btn text>Me</v-btn>
        </v-app-bar>
      </template>

      <v-container class="fill-height">
        <v-row align="center" justify="center">
          <v-col cols="12" md="8">
            <v-card class="mt-12">
              <v-card-title class="text-center mb-4">Feedback</v-card-title>
              <v-form @submit.prevent="submitForm">
                <v-container>
                  <v-row>
                    <v-col cols="12" md="6">
                      <v-text-field label="Name" v-model="formData.name" required></v-text-field>
                    </v-col>
                    <v-col cols="12" md="6">
                      <v-textarea label="Message" v-model="formData.message" required></v-textarea>
                    </v-col>
                  </v-row>
                  <v-row>
                    <v-col>
                      <v-checkbox v-model="formData.trends" label="1DðŸ”¼"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="4HðŸ”¼"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="1HðŸ”¼"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="LTFðŸ”¼"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="1DðŸ”½"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="4HðŸ”½"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="1HðŸ”½"></v-checkbox>
                      <v-checkbox v-model="formData.trends" label="LTFðŸ”½"></v-checkbox>
                    </v-col>
                  </v-row>
                  <v-row>
                    <v-col class="text-center">
                      <v-btn color="orange" @click="submitForm">Submit</v-btn>
                      <v-progress-circular
                        v-if="loading"
                        indeterminate
                        color="primary"
                      ></v-progress-circular>
                      <p v-if="successMessage">{{ successMessage }}</p>
                    </v-col>
                  </v-row>
                </v-container>
              </v-form>
            </v-card>
          </v-col>
        </v-row>
      </v-container>

    </v-app>
  </div>

  <script>
    new Vue({
      el: '#app',
      vuetify: new Vuetify(),
      data() {
        return {
          formData: {
            name: '',
            message: '',
            trends: []
          },
          scriptUrl: 'https://script.google.com/macros/s/AKfycbzFwFkxH8KtZ1xciZ3x3wMpP0X7PWOS1l7mvpSJItd9J23gtPZAXmDBhwztGFtPmBVk/exec',
          drawer: false,
          loading: false,
          successMessage: false,
        };
      },
      methods: {
        toggleDrawer() {
          this.drawer = !this.drawer;
        },
        // Submit the form and handle the loading state while making a POST request with form data.
        submitForm() {
          this.loading = true;
          const formData = new FormData();
          Object.keys(this.formData).forEach(key => {
            if (Array.isArray(this.formData[key])) {
              formData.append(key, this.formData[key].join(' '));
            } else {
              formData.append(key, this.formData[key]);
            }
          });
        
          fetch(this.scriptUrl, { method: 'POST', body: formData })
            .then(response => {
              this.successMessage = 'Form submitted successfully!';
              this.loading = false;
            })
            .catch(error => {
              alert('Error!', error.message);
              this.loading = false;
            });
        }
      },
    });
  </script>
</body>

</html>